ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 1
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"sensors.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.section	.text.sensors_user_modify,"ax",%progbits
  20              		.align	1
  21              		.global	sensors_user_modify
  22              		.syntax unified
  23              		.thumb
  24              		.thumb_func
  26              	sensors_user_modify:
  27              	.LVL0:
  28              	.LFB235:
  29              		.file 1 "Drivers/Sensors/sensors.c"
   1:Drivers/Sensors/sensors.c **** /*
   2:Drivers/Sensors/sensors.c **** File:                sensors.c
   3:Drivers/Sensors/sensors.c **** Written by:             Sang Truong Tan
   4:Drivers/Sensors/sensors.c **** Date Written:           02/12/2022
   5:Drivers/Sensors/sensors.c **** Description:
   6:Drivers/Sensors/sensors.c **** References:
   7:Drivers/Sensors/sensors.c **** 
   8:Drivers/Sensors/sensors.c **** *Copyright (C) 2022 - TTSang
   9:Drivers/Sensors/sensors.c ****    This is a free software under the GNU license, you can redistribute it and/or modify it under th
  10:Drivers/Sensors/sensors.c ****    of the GNU General Public Licenseversion 3 as published by the Free Software Foundation.
  11:Drivers/Sensors/sensors.c **** 
  12:Drivers/Sensors/sensors.c ****    This software library is shared with public for educational purposes, without WARRANTY and Autho
  13:Drivers/Sensors/sensors.c ****    or indirectly by this software, read more about this on the GNU General Public License.
  14:Drivers/Sensors/sensors.c **** */
  15:Drivers/Sensors/sensors.c **** 
  16:Drivers/Sensors/sensors.c **** /* Private includes ----------------------------------------------------------*/
  17:Drivers/Sensors/sensors.c **** #include "sensors.h"
  18:Drivers/Sensors/sensors.c **** 
  19:Drivers/Sensors/sensors.c **** /* Private variables ---------------------------------------------------------*/
  20:Drivers/Sensors/sensors.c **** 
  21:Drivers/Sensors/sensors.c **** /* Function definations ------------------------------------------------------*/
  22:Drivers/Sensors/sensors.c **** /**
  23:Drivers/Sensors/sensors.c ****  * @brief This function for user modify the initializations.
  24:Drivers/Sensors/sensors.c ****  * @param Handle The pointer of the handle type's sensor.
  25:Drivers/Sensors/sensors.c ****  * @param void
  26:Drivers/Sensors/sensors.c ****  */
  27:Drivers/Sensors/sensors.c **** void sensors_user_modify (Sensor_handle_t *Handle) {
  30              		.loc 1 27 52 view -0
  31              		.cfi_startproc
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 2


  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  34              		@ link register save eliminated.
  28:Drivers/Sensors/sensors.c ****   /* USER CODE BEGIN */
  29:Drivers/Sensors/sensors.c ****   //Enable the sensors
  30:Drivers/Sensors/sensors.c ****   Handle->enableHMC = true;
  35              		.loc 1 30 3 view .LVU1
  36              		.loc 1 30 21 is_stmt 0 view .LVU2
  37 0000 0123     		movs	r3, #1
  38 0002 80F88430 		strb	r3, [r0, #132]
  31:Drivers/Sensors/sensors.c ****   Handle->enableMPU = false;
  39              		.loc 1 31 3 is_stmt 1 view .LVU3
  40              		.loc 1 31 21 is_stmt 0 view .LVU4
  41 0006 0023     		movs	r3, #0
  42 0008 80F88530 		strb	r3, [r0, #133]
  32:Drivers/Sensors/sensors.c ****   //Init for the MPU
  33:Drivers/Sensors/sensors.c ****   Handle->mpuHandler.Init.ui8AcceFullScale = MPU6050_ACCE_FULLSCALE_2G;
  43              		.loc 1 33 3 is_stmt 1 view .LVU5
  44              		.loc 1 33 44 is_stmt 0 view .LVU6
  45 000c 0372     		strb	r3, [r0, #8]
  34:Drivers/Sensors/sensors.c ****   Handle->mpuHandler.Init.ui8GyroFullScale = MPU6050_GYRO_FULLSCALE_500DPS;
  46              		.loc 1 34 3 is_stmt 1 view .LVU7
  47              		.loc 1 34 44 is_stmt 0 view .LVU8
  48 000e 0822     		movs	r2, #8
  49 0010 4272     		strb	r2, [r0, #9]
  35:Drivers/Sensors/sensors.c ****   Handle->mpuHandler.Init.ui8DLPF = MPU6050_DLPF_4;
  50              		.loc 1 35 3 is_stmt 1 view .LVU9
  51              		.loc 1 35 35 is_stmt 0 view .LVU10
  52 0012 0422     		movs	r2, #4
  53 0014 8272     		strb	r2, [r0, #10]
  36:Drivers/Sensors/sensors.c ****   //Init for the HMC
  37:Drivers/Sensors/sensors.c ****   Handle->hmcHandler.Init.Average = HMC5883L_AVERAGING_8;
  54              		.loc 1 37 3 is_stmt 1 view .LVU11
  55              		.loc 1 37 35 is_stmt 0 view .LVU12
  56 0016 6022     		movs	r2, #96
  57 0018 80F87220 		strb	r2, [r0, #114]
  38:Drivers/Sensors/sensors.c ****   Handle->hmcHandler.Init.Bias = HMC5883L_BIAS_NORMAL;
  58              		.loc 1 38 3 is_stmt 1 view .LVU13
  59              		.loc 1 38 32 is_stmt 0 view .LVU14
  60 001c 80F87430 		strb	r3, [r0, #116]
  39:Drivers/Sensors/sensors.c ****   Handle->hmcHandler.Init.Gain = HMC5883L_GAIN_1090;
  61              		.loc 1 39 3 is_stmt 1 view .LVU15
  62              		.loc 1 39 32 is_stmt 0 view .LVU16
  63 0020 2022     		movs	r2, #32
  64 0022 80F87520 		strb	r2, [r0, #117]
  40:Drivers/Sensors/sensors.c ****   Handle->hmcHandler.Init.Mode = HMC5883L_MODE_CONTINUOUS;
  65              		.loc 1 40 3 is_stmt 1 view .LVU17
  66              		.loc 1 40 32 is_stmt 0 view .LVU18
  67 0026 80F87630 		strb	r3, [r0, #118]
  41:Drivers/Sensors/sensors.c ****   Handle->hmcHandler.Init.OutputRate = HMC5883L_RATE_75;
  68              		.loc 1 41 3 is_stmt 1 view .LVU19
  69              		.loc 1 41 38 is_stmt 0 view .LVU20
  70 002a 1823     		movs	r3, #24
  71 002c 80F87330 		strb	r3, [r0, #115]
  42:Drivers/Sensors/sensors.c ****   /* USER CODE END */
  43:Drivers/Sensors/sensors.c **** }
  72              		.loc 1 43 1 view .LVU21
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 3


  73 0030 7047     		bx	lr
  74              		.cfi_endproc
  75              	.LFE235:
  77              		.section	.text.sensors_init,"ax",%progbits
  78              		.align	1
  79              		.global	sensors_init
  80              		.syntax unified
  81              		.thumb
  82              		.thumb_func
  84              	sensors_init:
  85              	.LVL1:
  86              	.LFB236:
  44:Drivers/Sensors/sensors.c **** 
  45:Drivers/Sensors/sensors.c **** /**
  46:Drivers/Sensors/sensors.c ****   * @brief  Initialize sensors.
  47:Drivers/Sensors/sensors.c ****   * @param Handle The pointer of the handle type's sensor.
  48:Drivers/Sensors/sensors.c ****   * @retval Sensor_status_t
  49:Drivers/Sensors/sensors.c ****   */
  50:Drivers/Sensors/sensors.c **** Sensor_status_t sensors_init (Sensor_handle_t *Handle) {
  87              		.loc 1 50 56 is_stmt 1 view -0
  88              		.cfi_startproc
  89              		@ args = 0, pretend = 0, frame = 0
  90              		@ frame_needed = 0, uses_anonymous_args = 0
  91              		.loc 1 50 56 is_stmt 0 view .LVU23
  92 0000 38B5     		push	{r3, r4, r5, lr}
  93              	.LCFI0:
  94              		.cfi_def_cfa_offset 16
  95              		.cfi_offset 3, -16
  96              		.cfi_offset 4, -12
  97              		.cfi_offset 5, -8
  98              		.cfi_offset 14, -4
  99 0002 0446     		mov	r4, r0
  51:Drivers/Sensors/sensors.c ****   //Declare the variables
  52:Drivers/Sensors/sensors.c ****   Sensor_status_t senStatus = SENSOR_OK;
 100              		.loc 1 52 3 is_stmt 1 view .LVU24
 101              	.LVL2:
  53:Drivers/Sensors/sensors.c ****   MPU6050_State mpuState;
 102              		.loc 1 53 3 view .LVU25
  54:Drivers/Sensors/sensors.c ****   HMC5883L_State_t hmcState;
 103              		.loc 1 54 3 view .LVU26
  55:Drivers/Sensors/sensors.c ****   //Init the sensors
  56:Drivers/Sensors/sensors.c ****   sensors_user_modify(Handle);
 104              		.loc 1 56 3 view .LVU27
 105 0004 FFF7FEFF 		bl	sensors_user_modify
 106              	.LVL3:
  57:Drivers/Sensors/sensors.c ****   //Call the mpu init function
  58:Drivers/Sensors/sensors.c ****   if(Handle->enableMPU == true) {
 107              		.loc 1 58 3 view .LVU28
 108              		.loc 1 58 12 is_stmt 0 view .LVU29
 109 0008 94F88530 		ldrb	r3, [r4, #133]	@ zero_extendqisi2
 110              		.loc 1 58 5 view .LVU30
 111 000c 2BB9     		cbnz	r3, .L9
  52:Drivers/Sensors/sensors.c ****   MPU6050_State mpuState;
 112              		.loc 1 52 19 view .LVU31
 113 000e 0025     		movs	r5, #0
 114              	.L3:
 115              	.LVL4:
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 4


  59:Drivers/Sensors/sensors.c ****     mpuState = MPU6050_Init(Handle->mpuHandler.Init, Handle->mpuhi2c);
  60:Drivers/Sensors/sensors.c ****     if(mpuState != MPU6050_OK) {
  61:Drivers/Sensors/sensors.c ****       senStatus = SENSOR_ERROR_MPU;
  62:Drivers/Sensors/sensors.c ****     }
  63:Drivers/Sensors/sensors.c ****   }
  64:Drivers/Sensors/sensors.c ****   //Call the hmc init function
  65:Drivers/Sensors/sensors.c ****   if(Handle->enableHMC == true) {
 116              		.loc 1 65 3 is_stmt 1 view .LVU32
 117              		.loc 1 65 12 is_stmt 0 view .LVU33
 118 0010 94F88430 		ldrb	r3, [r4, #132]	@ zero_extendqisi2
 119              		.loc 1 65 5 view .LVU34
 120 0014 53B9     		cbnz	r3, .L10
 121              	.LVL5:
 122              	.L4:
  66:Drivers/Sensors/sensors.c ****     hmcState = HMC5883L_Init(&Handle->hmcHandler, Handle->hmchi2c);
  67:Drivers/Sensors/sensors.c ****     if(hmcState != HMC5883L_OK_STATE) {
  68:Drivers/Sensors/sensors.c ****       if(senStatus != SENSOR_OK) {
  69:Drivers/Sensors/sensors.c ****         senStatus = SENSOR_ERROR_BOTH;
  70:Drivers/Sensors/sensors.c ****       }
  71:Drivers/Sensors/sensors.c ****     }
  72:Drivers/Sensors/sensors.c ****   }
  73:Drivers/Sensors/sensors.c ****   return senStatus;
 123              		.loc 1 73 3 is_stmt 1 view .LVU35
  74:Drivers/Sensors/sensors.c **** }
 124              		.loc 1 74 1 is_stmt 0 view .LVU36
 125 0016 2846     		mov	r0, r5
 126 0018 38BD     		pop	{r3, r4, r5, pc}
 127              	.LVL6:
 128              	.L9:
  59:Drivers/Sensors/sensors.c ****     mpuState = MPU6050_Init(Handle->mpuHandler.Init, Handle->mpuhi2c);
 129              		.loc 1 59 5 is_stmt 1 view .LVU37
  59:Drivers/Sensors/sensors.c ****     mpuState = MPU6050_Init(Handle->mpuHandler.Init, Handle->mpuhi2c);
 130              		.loc 1 59 16 is_stmt 0 view .LVU38
 131 001a E16F     		ldr	r1, [r4, #124]
 132 001c A068     		ldr	r0, [r4, #8]
 133 001e FFF7FEFF 		bl	MPU6050_Init
 134              	.LVL7:
  60:Drivers/Sensors/sensors.c ****       senStatus = SENSOR_ERROR_MPU;
 135              		.loc 1 60 5 is_stmt 1 view .LVU39
  60:Drivers/Sensors/sensors.c ****       senStatus = SENSOR_ERROR_MPU;
 136              		.loc 1 60 7 is_stmt 0 view .LVU40
 137 0022 0546     		mov	r5, r0
 138 0024 0028     		cmp	r0, #0
 139 0026 F3D0     		beq	.L3
  61:Drivers/Sensors/sensors.c ****     }
 140              		.loc 1 61 17 view .LVU41
 141 0028 0125     		movs	r5, #1
 142 002a F1E7     		b	.L3
 143              	.LVL8:
 144              	.L10:
  66:Drivers/Sensors/sensors.c ****     if(hmcState != HMC5883L_OK_STATE) {
 145              		.loc 1 66 5 is_stmt 1 view .LVU42
  66:Drivers/Sensors/sensors.c ****     if(hmcState != HMC5883L_OK_STATE) {
 146              		.loc 1 66 16 is_stmt 0 view .LVU43
 147 002c D4F88010 		ldr	r1, [r4, #128]
 148 0030 04F11C00 		add	r0, r4, #28
 149 0034 FFF7FEFF 		bl	HMC5883L_Init
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 5


 150              	.LVL9:
  67:Drivers/Sensors/sensors.c ****       if(senStatus != SENSOR_OK) {
 151              		.loc 1 67 5 is_stmt 1 view .LVU44
  67:Drivers/Sensors/sensors.c ****       if(senStatus != SENSOR_OK) {
 152              		.loc 1 67 7 is_stmt 0 view .LVU45
 153 0038 0028     		cmp	r0, #0
 154 003a ECD0     		beq	.L4
  68:Drivers/Sensors/sensors.c ****         senStatus = SENSOR_ERROR_BOTH;
 155              		.loc 1 68 7 is_stmt 1 view .LVU46
  68:Drivers/Sensors/sensors.c ****         senStatus = SENSOR_ERROR_BOTH;
 156              		.loc 1 68 9 is_stmt 0 view .LVU47
 157 003c 002D     		cmp	r5, #0
 158 003e EAD0     		beq	.L4
  69:Drivers/Sensors/sensors.c ****       }
 159              		.loc 1 69 19 view .LVU48
 160 0040 0325     		movs	r5, #3
 161              	.LVL10:
  69:Drivers/Sensors/sensors.c ****       }
 162              		.loc 1 69 19 view .LVU49
 163 0042 E8E7     		b	.L4
 164              		.cfi_endproc
 165              	.LFE236:
 167              		.section	.text.sensors_update,"ax",%progbits
 168              		.align	1
 169              		.global	sensors_update
 170              		.syntax unified
 171              		.thumb
 172              		.thumb_func
 174              	sensors_update:
 175              	.LVL11:
 176              	.LFB237:
  75:Drivers/Sensors/sensors.c **** 
  76:Drivers/Sensors/sensors.c **** /**
  77:Drivers/Sensors/sensors.c ****   * @brief  Update sensors data. Must be call as interval with the dt value.
  78:Drivers/Sensors/sensors.c ****   * @param Handle The pointer of the handle type's sensor.
  79:Drivers/Sensors/sensors.c ****   * @retval Sensor_status_t
  80:Drivers/Sensors/sensors.c ****   */
  81:Drivers/Sensors/sensors.c **** Sensor_status_t sensors_update (Sensor_handle_t *Handle) {
 177              		.loc 1 81 58 is_stmt 1 view -0
 178              		.cfi_startproc
 179              		@ args = 0, pretend = 0, frame = 8
 180              		@ frame_needed = 0, uses_anonymous_args = 0
  82:Drivers/Sensors/sensors.c ****   //Get the mpu data
  83:Drivers/Sensors/sensors.c ****   //Get the hmc data
  84:Drivers/Sensors/sensors.c ****   HMC5883L_Raw_t hmcRaw;
 181              		.loc 1 84 3 view .LVU51
  85:Drivers/Sensors/sensors.c ****   if(Handle->enableHMC == true) {
 182              		.loc 1 85 3 view .LVU52
 183              		.loc 1 85 12 is_stmt 0 view .LVU53
 184 0000 90F88430 		ldrb	r3, [r0, #132]	@ zero_extendqisi2
 185              		.loc 1 85 5 view .LVU54
 186 0004 0BB9     		cbnz	r3, .L17
  86:Drivers/Sensors/sensors.c ****     hmcRaw = HMC5883L_Get_Raw(&Handle->hmcHandler);
  87:Drivers/Sensors/sensors.c ****   }
  88:Drivers/Sensors/sensors.c ****   return SENSOR_OK;
 187              		.loc 1 88 3 is_stmt 1 view .LVU55
  89:Drivers/Sensors/sensors.c **** }
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 6


 188              		.loc 1 89 1 is_stmt 0 view .LVU56
 189 0006 0020     		movs	r0, #0
 190              	.LVL12:
 191              		.loc 1 89 1 view .LVU57
 192 0008 7047     		bx	lr
 193              	.LVL13:
 194              	.L17:
  81:Drivers/Sensors/sensors.c ****   //Get the mpu data
 195              		.loc 1 81 58 view .LVU58
 196 000a 00B5     		push	{lr}
 197              	.LCFI1:
 198              		.cfi_def_cfa_offset 4
 199              		.cfi_offset 14, -4
 200 000c 83B0     		sub	sp, sp, #12
 201              	.LCFI2:
 202              		.cfi_def_cfa_offset 16
  86:Drivers/Sensors/sensors.c ****     hmcRaw = HMC5883L_Get_Raw(&Handle->hmcHandler);
 203              		.loc 1 86 5 is_stmt 1 view .LVU59
  86:Drivers/Sensors/sensors.c ****     hmcRaw = HMC5883L_Get_Raw(&Handle->hmcHandler);
 204              		.loc 1 86 14 is_stmt 0 view .LVU60
 205 000e 00F11C01 		add	r1, r0, #28
 206 0012 6846     		mov	r0, sp
 207              	.LVL14:
  86:Drivers/Sensors/sensors.c ****     hmcRaw = HMC5883L_Get_Raw(&Handle->hmcHandler);
 208              		.loc 1 86 14 view .LVU61
 209 0014 FFF7FEFF 		bl	HMC5883L_Get_Raw
 210              	.LVL15:
  88:Drivers/Sensors/sensors.c **** }
 211              		.loc 1 88 3 is_stmt 1 view .LVU62
 212              		.loc 1 89 1 is_stmt 0 view .LVU63
 213 0018 0020     		movs	r0, #0
 214 001a 03B0     		add	sp, sp, #12
 215              	.LCFI3:
 216              		.cfi_def_cfa_offset 4
 217              		@ sp needed
 218 001c 5DF804FB 		ldr	pc, [sp], #4
 219              		.cfi_endproc
 220              	.LFE237:
 222              		.text
 223              	.Letext0:
 224              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 225              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 226              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 227              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 228              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 229              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_i2c.h"
 230              		.file 8 "Drivers/MPU6050/Inc/ST_MPU6050.h"
 231              		.file 9 "Drivers/HMC5883/Inc/HMC5883.h"
 232              		.file 10 "Drivers/Sensors/sensors.h"
ARM GAS  C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s 			page 7


DEFINED SYMBOLS
                            *ABS*:00000000 sensors.c
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:20     .text.sensors_user_modify:00000000 $t
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:26     .text.sensors_user_modify:00000000 sensors_user_modify
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:78     .text.sensors_init:00000000 $t
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:84     .text.sensors_init:00000000 sensors_init
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:168    .text.sensors_update:00000000 $t
C:\Users\sangt\AppData\Local\Temp\ccVAiE1e.s:174    .text.sensors_update:00000000 sensors_update

UNDEFINED SYMBOLS
MPU6050_Init
HMC5883L_Init
HMC5883L_Get_Raw
